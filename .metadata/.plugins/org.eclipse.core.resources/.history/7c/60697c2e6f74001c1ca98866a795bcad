package com.challenge.crawler.service;

import java.util.List;
import java.util.Map;
import java.util.stream.Collectors;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;
import org.springframework.util.StringUtils;

import com.challenge.crawler.dto.AutomobileInfo;
import com.challenge.crawler.model.Automobile;
import com.challenge.crawler.repo.AutomobileRepository;

@Service
public class MainService {
	
	@Autowired
	AutomobileRepository autoRepo;
	
	
	public void save(Automobile auto)
	{
		this.autoRepo.save(auto);
	}
	
	public void save(List<Automobile> autoList)
	{
		this.autoRepo.saveAll(autoList);
	}
	
	public List<Automobile> fetchAllAutombiles()
	{
		List<Automobile> autoList = this.autoRepo.findAll();
		
	}
	
	private List<AutomobileInfo> buildAutomobileDTO(List<Automobile> autoList)
	{
		if(autoList != null && autoList.size() > 0)
		{
			List<AutomobileInfo> autoInfoList = autoList.stream().map(x -> {
				
				AutomobileInfo a = new AutomobileInfo();
				if(x.getManufacturer() != null)
				{
					a.setManufacturer(x.getManufacturer());
				}
				if(!StringUtils.isEmpty(x.getAssembly()))
				{
					a.setAssembly(x.getAssembly());
				}
				if(!StringUtils.isEmpty(x.getName()))
				{
					a.setName(x.getName());
				}
				if(!StringUtils.isEmpty(x.getNotes()))
				{
					a.setNotes(x.getNotes());
				}
				if(!StringUtils.isEmpty(x.getSales()))
				{
					a.setSales(x.getSales());
				}
				if(!StringUtils.isEmpty(x.getProdYear()))
				{
					a.setProdYear(x.getProdYear());
				}
				return a;
			}).collect(Collectors.toList());
		}
	}

}
